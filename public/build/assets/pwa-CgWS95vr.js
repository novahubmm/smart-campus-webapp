"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(e=>{console.log("Service Worker registered successfully:",e.scope),e.addEventListener("updatefound",()=>{const o=e.installing;console.log("Service Worker update found"),o.addEventListener("statechange",()=>{o.state==="installed"&&navigator.serviceWorker.controller&&i()})})}).catch(e=>{console.error("Service Worker registration failed:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("New Service Worker activated"),window.location.reload()})});function i(){confirm("A new version is available! Reload to update?")&&window.location.reload()}window.deferredPrompt=null;window.addEventListener("beforeinstallprompt",e=>{console.log("PWA install prompt triggered"),e.preventDefault(),window.deferredPrompt=e,s()});window.addEventListener("appinstalled",e=>{console.log("PWA was installed successfully"),window.deferredPrompt=null,window.dispatchEvent(new CustomEvent("pwa-installed")),typeof t=="function"&&t("App installed successfully!","success")});function s(){const e=document.getElementById("pwa-install-banner");e&&(e.style.display="block")}window.installPWA=async()=>{if(!window.deferredPrompt){console.log("No install prompt available");return}window.deferredPrompt.prompt();const{outcome:e}=await window.deferredPrompt.userChoice;console.log(`User response to install prompt: ${e}`),console.log(e==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),window.deferredPrompt=null;const o=document.getElementById("pwa-install-banner");o&&(o.style.display="none")};function r(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}window.addEventListener("online",()=>{console.log("App is online"),document.body.classList.remove("offline"),t("You are back online!","success"),"serviceWorker"in navigator&&"sync"in ServiceWorkerRegistration.prototype&&navigator.serviceWorker.ready.then(e=>e.sync.register("sync-forms"))});window.addEventListener("offline",()=>{console.log("App is offline"),document.body.classList.add("offline"),t("You are offline. Some features may be limited.","warning")});function t(e,o="info"){const n=document.createElement("div");n.className=`pwa-toast pwa-toast-${o}`,n.textContent=e,document.body.appendChild(n),setTimeout(()=>{n.classList.add("show")},100),setTimeout(()=>{n.classList.remove("show"),setTimeout(()=>{document.body.removeChild(n)},300)},3e3)}navigator.onLine||document.body.classList.add("offline");console.log("PWA Mode:",r()?"Installed":"Browser");console.log("Online Status:",navigator.onLine?"Online":"Offline");
