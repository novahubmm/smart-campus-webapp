<!-- Payment Summary -->
<div class="bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
    <h5 class="text-sm font-semibold text-gray-900 dark:text-white mb-3">{{ __('finance.Payment Summary') }}</h5>
    <p class="text-xs text-gray-500 dark:text-gray-400 mb-3">{{ __('finance.Review your payment details') }}</p>
    
    <!-- Fees Breakdown -->
    <div class="space-y-3">
        <p class="text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide">{{ __('finance.FEES BREAKDOWN') }}</p>
        
        <template x-for="(fee, index) in paymentData.fees" :key="fee.id">
            <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                <div class="flex-1">
                    <p class="font-medium text-gray-900 dark:text-white" x-text="fee.fee_name"></p>
                    <p class="text-xs text-gray-500" x-text="'{{ __('finance.Due') }}: ' + formatDueDate(fee.due_date)"></p>
                    <!-- Show calculation for full payment with multiple months -->
                    <template x-if="paymentData.payment_type === 'full' && fee.payment_months > 1">
                        <p class="text-xs text-teal-600 dark:text-teal-400 mt-1" x-text="fee.remaining_amount.toLocaleString() + ' MMK Ã— ' + fee.payment_months + ' = ' + (fee.remaining_amount * fee.payment_months).toLocaleString() + ' MMK'"></p>
                    </template>
                </div>
                <div class="flex items-center gap-2">
                    <template x-if="paymentData.payment_type === 'partial'">
                        <div class="flex items-center gap-2">
                            <button type="button" @click="adjustFeeAmount(index, -500)" class="w-7 h-7 rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 flex items-center justify-center">
                                <i class="fas fa-minus text-xs"></i>
                            </button>
                            <input type="number" :name="'fee_amounts[' + fee.id + ']'" x-model.number="fee.payment_amount" @blur="roundToNearest500(index)" :max="fee.remaining_amount" min="0" step="500" class="w-24 px-2 py-1 text-center text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-semibold">
                            <button type="button" @click="adjustFeeAmount(index, 500)" class="w-7 h-7 rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 flex items-center justify-center">
                                <i class="fas fa-plus text-xs"></i>
                            </button>
                        </div>
                    </template>
                    <template x-if="paymentData.payment_type === 'full'">
                        <div class="text-right">
                            <span class="font-bold text-gray-900 dark:text-white block" x-text="(fee.remaining_amount * fee.payment_months).toLocaleString() + ' MMK'"></span>
                        </div>
                    </template>
                </div>
            </div>
        </template>
    </div>

    <!-- Subtotal, Discount, Total -->
    <div class="mt-4 space-y-2 pt-3 border-t border-gray-300 dark:border-gray-600">
        <div class="flex items-center justify-between text-sm">
            <span class="text-gray-600 dark:text-gray-400">{{ __('finance.Subtotal') }}</span>
            <span class="font-semibold text-gray-900 dark:text-white" x-text="paymentData.subtotal.toLocaleString() + ' MMK'"></span>
        </div>
        <template x-if="paymentData.discount > 0">
            <div class="flex items-center justify-between text-sm">
                <span class="text-green-600 dark:text-green-400">{{ __('finance.Discount') }} (<span x-text="paymentData.discountPercent"></span>% {{ __('finance.on School Fee') }})</span>
                <span class="font-semibold text-green-600 dark:text-green-400" x-text="'- ' + paymentData.discount.toLocaleString() + ' MMK'"></span>
            </div>
        </template>
    </div>

    <!-- Total Amount -->
    <div class="mt-4 p-4 bg-gradient-to-br from-teal-500 to-emerald-500 rounded-lg">
        <div class="flex items-center justify-between text-white">
            <span class="font-semibold">{{ __('finance.Total Amount') }}</span>
            <span class="font-bold text-2xl" x-text="paymentData.total.toLocaleString() + ' MMK'"></span>
        </div>
    </div>
</div>
